// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  name      String
  email     String   @unique
  phone     String?
  password  String   // Hash da senha
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

model Auxiliar {
  id             Int      @id @default(autoincrement())
  nome           String
  foto           String?
  email          String?
  dataNascimento DateTime
  igreja         String
  regiao         String
  estadoCivil    String
  telefone       String
  obreiro        Boolean  @default(false)
  batizado       Boolean  @default(false)
  dataCadastro   DateTime @default(now())

  // Relacionamentos
  enderecoResidencial   Endereco? @relation("EnderecoResidencial", fields: [enderecoResidencialId], references: [id])
  enderecoResidencialId Int?

  enderecoIgreja   Endereco? @relation("EnderecoIgreja", fields: [enderecoIgrejaId], references: [id])
  enderecoIgrejaId Int?

  conjuge   Conjuge? @relation(fields: [conjugeId], references: [id])
  conjugeId Int?     @unique
}

model Endereco {
  id              Int     @id @default(autoincrement())
  tipo            String // "Residencial" ou "Igreja"
  provincia       String
  municipio       String
  bairro          String
  rua             String
  numeroCasa      String?
  pontoReferencia String?

  // Relações inversas (facultativas)
  auxiliarResidencial Auxiliar[] @relation("EnderecoResidencial")
  auxiliarIgreja      Auxiliar[] @relation("EnderecoIgreja")
}

model Conjuge {
  id       Int     @id @default(autoincrement())
  nome     String
  telefone String
  foto     String?
  obreiro  Boolean @default(false)
  batizado Boolean @default(false)

  auxiliar Auxiliar?
}